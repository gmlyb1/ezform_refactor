<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ezform.mapper.notification_Mapper">
	
	<select id="getUnread" parameterType="EZ_notificationVO" resultType="EZ_notificationVO">
    	select
	        noti_id,
	        receiver_name,
	        noti_type,
	        noti_message,
	        noti_link,
	        create_date
	    from ez_notification
	    where receiver_name = #{receiver_name}
	      and is_read = 'N'
	    order by create_date DESC
	</select>
	
	<select id="selectNotificationList" parameterType="EZ_notificationVO" resultType="EZ_notificationVO">
		select 
			noti_id
			,receiver_name
			,noti_type
			,noti_message
			,noti_link
			,is_read
			,create_date
		from ez_notification
		where receiver_name = #{receiver_name}
	</select>
	
	<select id="getUnreadMessageList" parameterType="EZ_notificationVO" resultType="EZ_notificationVO">
		select 
			noti_id
			,receiver_name
			,noti_type
			,noti_message
			,noti_link
			,is_read
			,create_date
		from ez_notification
		where receiver_name = #{receiver_name}
		and is_read = 'N'
	</select>
	
	<insert id="insertNotification">
		insert into ez_notification
		(
			 noti_id
			,receiver_name
			,noti_type
			,noti_message
			,noti_link
			,is_read
			,create_date
		)
		values
		(
			  #{noti_id}
			, #{receiver_name}
			, #{noti_type}
			, #{noti_message}
			, #{noti_link}
			, 'N'
			, NOW()
		)
	</insert>
	
	<update id="updateAllRead">
		update ez_notification set 
		is_read = 'Y'
		where receiver_name = #{receiver_name}
	</update>


</mapper>
